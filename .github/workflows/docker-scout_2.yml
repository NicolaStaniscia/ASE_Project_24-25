name: Docker Scout Analysis

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:

   push-and-analize:
    runs-on: ubuntu-latest

    steps:
      
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Log in to Docker Hub
      uses: docker/login-action@v3
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}
        
    # Step 4: Setup Docker
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3

    - name: Build the Docker image
      run: |
        docker build -t collection_db_manager src/collection/collection_db_manager
        docker build -t edit_gacha_collection src/collection/edit_gacha_collection
        docker build -t roll_gacha src/collection/roll_gacha
        docker build -t see_gacha_collection src/collection/see_gacha_collection
        docker build -t auction_market src/market/auction_market
        docker build -t market_db_manager src/market/dbm
        docker build -t trading_history src/market/trading_history
        docker build -t account_management src/users/account_management
        docker build -t users_db_manager src/users/db_manager

    - name: Print images
      run: docker images
